
AV.init({
    appId: "VJ2hnUj8YTC6bcoz7Xw8XKq5-gzGzoHsz",
    appKey: "yQcrJgrr3gI6JGLeeAxFvymS",
    serverURLs: "https://vj2hnuj8.lc-cn-n1-shared.com"
});
localStorage.setItem('debug', 'leancloud*');

function init() {

    var currentUser = AV.User.current();
    if (currentUser) {
        // 当前有用户
        alert("欢迎用户 "+currentUser.get("username"));
    } else {
        // 当前没有用户
    }


}

var requestApi = function getInstance() {
        var instance;
        if(instance){
            return instance;
        } else {
            init();
            instance = new requestApi;
        }
};

function registerAccount() {
    var userName = document.getElementById("username").value;
    var password = document.getElementById("pass").value;
    var passwordConfirm = document.getElementById("pass_confirm").value;
    if (password == passwordConfirm) {
        console.log('密码一致')
        register(userName,password);
    } else {
        console.log('密码不一致')
    }
}

function register(userName, passWord) {
    var user = new AV.User();
    user.setUsername(userName);
    user.setPassword(passWord);
    user.signUp().then(function (user) {
        console.log('注册成功。')
        user.save().then(function (user) {
            // 注册成功
            console.log('上传用户信息成功');
            window.location.href="./login.html"
        },function (error) {
            // 注册成功
            console.log('上传用户信息失败')
            window.location.href="./login.html"
        })
    }, function (error) {
        console.log(error)
        alert(error);
        // 注册失败（通常是因为用户名已被使用）
        return;
    });
}
